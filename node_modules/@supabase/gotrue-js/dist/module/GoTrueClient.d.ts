import GoTrueApi from './GoTrueApi';
import { Session, User, UserAttributes, Provider, Subscription, AuthChangeEvent } from './lib/types';
export default class GoTrueClient {
    /**
     * Namespace for the GoTrue API methods.
     * These can be used for example to get a user from a JWT in a server environment or reset a user's password.
     */
    api: GoTrueApi;
    /**
     * The currently logged in user or null.
     */
    protected currentUser: User | null;
    /**
     * The session object for the currently logged in user or null.
     */
    protected currentSession: Session | null;
    protected autoRefreshToken: boolean;
    protected persistSession: boolean;
    protected localStorage: Storage;
    protected stateChangeEmmitters: Map<string, Subscription>;
    /**
     * Create a new client for use in the browser.
     * @param options.url The URL of the GoTrue server.
     * @param options.headers Any additional headers to send to the GoTrue server.
     * @param options.detectSessionInUrl Set to "true" if you want to automatically detects OAuth grants in the URL and signs in the user.
     * @param options.autoRefreshToken Set to "true" if you want to automatically refresh the token before expiring.
     * @param options.persistSession Set to "true" if you want to automatically save the user session into local storage.
     * @param options.localStorage
     */
    constructor(options: {
        url?: string;
        headers?: {
            [key: string]: string;
        };
        detectSessionInUrl?: boolean;
        autoRefreshToken?: boolean;
        persistSession?: boolean;
        localStorage?: Storage;
    });
    /**
     * Creates a new user.
     * @param credentials The user login details.
     * @param credentials.email The user's email address.
     * @param credentials.password The user's password.
     */
    signUp(credentials: {
        email: string;
        password: string;
    }): Promise<{
        data: Session | null;
        user: User | null;
        error: Error | null;
    }>;
    /**
     * Log in an existing user, or login via a third-party provider.
     * @param credentials The user login details.
     * @param credentials.email The user's email address.
     * @param credentials.password The user's password.
     * @param credentials.provider One of the providers supported by GoTrue.
     */
    signIn(credentials: {
        email?: string;
        password?: string;
        provider?: Provider;
    }): Promise<{
        data: Session | null;
        user: User | null;
        provider?: Provider;
        url?: string | null;
        error: Error | null;
    }>;
    /**
     * Returns the user data, if there is a logged in user.
     */
    user(): User | null;
    /**
     * Returns the session data, if there is an active session.
     */
    session(): Session | null;
    /**
     * Force refreshes the session including the user data in case it was updated in a different session.
     */
    refreshSession(): Promise<{
        data: Session | null;
        user: User | null;
        error: Error | null;
    }>;
    /**
     * Updates user data, if there is a logged in user.
     */
    update(attributes: UserAttributes): Promise<{
        data: User | null;
        user: User | null;
        error: Error | null;
    }>;
    /**
     * Gets the session data from a URL string
     * @param options.storeSession Optionally store the session in the browser
     */
    getSessionFromUrl(options?: {
        storeSession?: boolean;
    }): Promise<{
        data: Session | null;
        error: Error | null;
    }>;
    /**
     * Signs out the current user, if there is a logged in user.
     */
    signOut(): Promise<{
        error: Error | null;
    }>;
    /**
     * Receive a notification every time an auth event happens.
     * @returns {Subscription} A subscription object which can be used to unsubcribe itself.
     */
    onAuthStateChange(callback: (event: AuthChangeEvent, session: Session | null) => void): {
        data: Subscription | null;
        error: Error | null;
    };
    private _handeEmailSignIn;
    private _handeProviderSignIn;
    private _saveSession;
    private _persistSession;
    private _removeSession;
    private _recoverSession;
    private _callRefreshToken;
    private _notifyAllSubscribers;
}
//# sourceMappingURL=GoTrueClient.d.ts.map